
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <title>Testing Â· Fabric8 Documentation</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.0.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="forge.html" />
    
    
    <link rel="prev" href="tools.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="overview.html">
            
                <a href="overview.html">
            
                    
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="getStarted/">
            
                <a href="getStarted/">
            
                    
                    Getting Started
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="getStarted/vagrant.html">
            
                <a href="getStarted/vagrant.html">
            
                    
                    Use Vagrant
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="getStarted/kubernetes.html">
            
                <a href="getStarted/kubernetes.html">
            
                    
                    Use Kubernetes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="getStarted/gke.html">
            
                <a href="getStarted/gke.html">
            
                    
                    Use Kubernetes on GKE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="getStarted/openshift.html">
            
                <a href="getStarted/openshift.html">
            
                    
                    Use OpenShift
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1" data-path="getStarted/installOpenShift.html">
            
                <a href="getStarted/installOpenShift.html">
            
                    
                    Install OpenShift
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="getStarted/cdk.html">
            
                <a href="getStarted/cdk.html">
            
                    
                    Use CDK
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="getStarted/apps.html">
            
                <a href="getStarted/apps.html">
            
                    
                    Installing apps
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="getStarted/local.html">
            
                <a href="getStarted/local.html">
            
                    
                    Setup Local OpenShift Client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="getStarted/develop.html">
            
                <a href="getStarted/develop.html">
            
                    
                    Develop locally
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="getStarted/browserCertificates.html">
            
                <a href="getStarted/browserCertificates.html">
            
                    
                    Accept self-signed certs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.10" data-path="getStarted/troubleshooting.html">
            
                <a href="getStarted/troubleshooting.html">
            
                    
                    Troubleshooting
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="develop/">
            
                <a href="develop/">
            
                    
                    Developing Microservices
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="develop/elasticity.html">
            
                <a href="develop/elasticity.html">
            
                    
                    Elasticity and Resilience
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="develop/designForFailure.html">
            
                <a href="develop/designForFailure.html">
            
                    
                    Design for Failure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="develop/serviceDiscovery.html">
            
                <a href="develop/serviceDiscovery.html">
            
                    
                    Service Discovery
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="develop/loadBalancing.html">
            
                <a href="develop/loadBalancing.html">
            
                    
                    Load balancing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="develop/pipelines.html">
            
                <a href="develop/pipelines.html">
            
                    
                    Pipelines
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="develop/logging.html">
            
                <a href="develop/logging.html">
            
                    
                    Logging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="develop/monitoring.html">
            
                <a href="develop/monitoring.html">
            
                    
                    Monitoring
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="develop/tracing.html">
            
                <a href="develop/tracing.html">
            
                    
                    Tracing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="develop/circuitBreakers.html">
            
                <a href="develop/circuitBreakers.html">
            
                    
                    Circuit Breakers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.10" data-path="develop/configuration.html">
            
                <a href="develop/configuration.html">
            
                    
                    Configuration
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="fabric8DevOps.html">
            
                <a href="fabric8DevOps.html">
            
                    
                    Microservices Platform
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="console.html">
            
                <a href="console.html">
            
                    
                    Developer Console
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="cdelivery.html">
            
                <a href="cdelivery.html">
            
                    
                    CI and CD
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1" data-path="jenkinsWorkflowLibrary.html">
            
                <a href="jenkinsWorkflowLibrary.html">
            
                    
                    Jenkins Workflow Library
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.2" data-path="fabric8YmlFile.html">
            
                <a href="fabric8YmlFile.html">
            
                    
                    fabric8.yml file
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="management.html">
            
                <a href="management.html">
            
                    
                    Management
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.3.1" data-path="logging.html">
            
                <a href="logging.html">
            
                    
                    Logging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.2" data-path="metrics.html">
            
                <a href="metrics.html">
            
                    
                    Metrics
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="chat.html">
            
                <a href="chat.html">
            
                    
                    Chat
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="chaosMonkey.html">
            
                <a href="chaosMonkey.html">
            
                    
                    Chaos Monkey
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="ipaas.html">
            
                <a href="ipaas.html">
            
                    
                    Integration
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="fabric8MQ.html">
            
                <a href="fabric8MQ.html">
            
                    
                    Messaging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="apiManagement.html">
            
                <a href="apiManagement.html">
            
                    
                    API Management
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.2.1" data-path="apimanComponents.html">
            
                <a href="apimanComponents.html">
            
                    
                    Apiman Components
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.2" data-path="apimanGettingStarted.html">
            
                <a href="apimanGettingStarted.html">
            
                    
                    Getting Started
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.3" data-path="apimanDataModel.html">
            
                <a href="apimanDataModel.html">
            
                    
                    Data Model
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.4" data-path="apimanImportService.html">
            
                <a href="apimanImportService.html">
            
                    
                    Publish Service
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.5" data-path="apimanConsumeService.html">
            
                <a href="apimanConsumeService.html">
            
                    
                    Consume a Service
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="quickstarts/">
            
                <a href="quickstarts/">
            
                    
                    Quickstarts
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="quickstarts/archetypes.html">
            
                <a href="quickstarts/archetypes.html">
            
                    
                    Archetypes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="quickstarts/running.html">
            
                <a href="quickstarts/running.html">
            
                    
                    Running
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="quickstarts/walkthrough.html">
            
                <a href="quickstarts/walkthrough.html">
            
                    
                    Walk-through
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="tools.html">
            
                <a href="tools.html">
            
                    
                    Tools
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.8.1" data-path="testing.html">
            
                <a href="testing.html">
            
                    
                    Testing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="forge.html">
            
                <a href="forge.html">
            
                    
                    Forge
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.2.1" data-path="camelMavenPlugin.html">
            
                <a href="camelMavenPlugin.html">
            
                    
                    Camel Maven Plugin
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="mavenPlugin.html">
            
                <a href="mavenPlugin.html">
            
                    
                    Maven Plugin
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.3.1" data-path="mavenDockerBuild.html">
            
                <a href="mavenDockerBuild.html">
            
                    
                    docker:build
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.2" data-path="mavenDockerPush.html">
            
                <a href="mavenDockerPush.html">
            
                    
                    docker:push
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.3" data-path="mavenFabric8Apply.html">
            
                <a href="mavenFabric8Apply.html">
            
                    
                    fabric8:apply
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.4" data-path="mavenFabric8CreateEnv.html">
            
                <a href="mavenFabric8CreateEnv.html">
            
                    
                    fabric8:create-env
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.5" data-path="mavenFabric8CreateRoutes.html">
            
                <a href="mavenFabric8CreateRoutes.html">
            
                    
                    fabric8:create-routes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.6" data-path="mavenFabric8DeletePods.html">
            
                <a href="mavenFabric8DeletePods.html">
            
                    
                    fabric8:delete-pods
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.7" data-path="mavenFabric8DevOps.html">
            
                <a href="mavenFabric8DevOps.html">
            
                    
                    fabric8:devops
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.8" data-path="mavenFabric8Helm.html">
            
                <a href="mavenFabric8Helm.html">
            
                    
                    fabric8:helm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.9" data-path="mavenFabric8HelmPush.html">
            
                <a href="mavenFabric8HelmPush.html">
            
                    
                    fabric8:helm-push
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.10" data-path="mavenFabric8Json.html">
            
                <a href="mavenFabric8Json.html">
            
                    
                    fabric8:json
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.3.10.1" data-path="annotationProcessors.html">
            
                <a href="annotationProcessors.html">
            
                    
                    annotation processors
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.3.11" data-path="mavenFabric8Recreate.html">
            
                <a href="mavenFabric8Recreate.html">
            
                    
                    fabric8:recreate
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.12" data-path="mavenFabric8Rolling.html">
            
                <a href="mavenFabric8Rolling.html">
            
                    
                    fabric8:rolling
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="helm.html">
            
                <a href="helm.html">
            
                    
                    Helm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5" data-path="javaLibraries.html">
            
                <a href="javaLibraries.html">
            
                    
                    Java Libraries
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.6" data-path="cdi.html">
            
                <a href="cdi.html">
            
                    
                    CDI
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="annotations.html">
            
                <a href="annotations.html">
            
                    
                    Annotations
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="secretAnnotations.html">
            
                <a href="secretAnnotations.html">
            
                    
                    Secret Annotations
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="architecture.html">
            
                <a href="architecture.html">
            
                    
                    Architecture
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="pods.html">
            
                <a href="pods.html">
            
                    
                    Pods
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="replicationControllers.html">
            
                <a href="replicationControllers.html">
            
                    
                    Replication Controllers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="labels.html">
            
                <a href="labels.html">
            
                    
                    Labels
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" data-path="services.html">
            
                <a href="services.html">
            
                    
                    Services
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.5" data-path="apps.html">
            
                <a href="apps.html">
            
                    
                    Apps
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.6" data-path="environments.html">
            
                <a href="environments.html">
            
                    
                    Environments
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.7" data-path="builds.html">
            
                <a href="builds.html">
            
                    
                    Builds
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="projects.html">
            
                <a href="projects.html">
            
                    
                    Source Code
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="v2-changes.html">
            
                <a href="v2-changes.html">
            
                    
                    Changes from V1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="FAQ.html">
            
                <a href="FAQ.html">
            
                    
                    FAQ
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="faqGeneral.html">
            
                <a href="faqGeneral.html">
            
                    
                    General Questions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2" data-path="faqFuse.html">
            
                <a href="faqFuse.html">
            
                    
                    JBoss Fuse Questions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.3" data-path="faqKubernetes.html">
            
                <a href="faqKubernetes.html">
            
                    
                    Kubernetes Questions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.4" >
            
                <a target="_blank" href="https://help.openshift.com/hc/en-us/categories/200177370-Frequently-Asked-Questions">
            
                    
                    OpenShift Questions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Testing</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="integration-and-system-testing"><a name="undefined" class="plugin-anchor" href="#undefined"><span class="fa fa-link"></span></a>Integration and System Testing</h2>
<p>Fabric8 supports integration testing of <a href="apps.html">Apps</a> using Kubernetes via <a href="https://github.com/fabric8io/fabric8/tree/master/components/fabric8-arquillian" _target="blank">fabric8-arquillian</a> which provides an extension for <a href="http://arquillian.org/" _target="blank">Arquillian</a>.</p>
<p>Using this extension you can easily:</p>
<ul>
<li>Apply the kubernetes configuration of your application, including its dependencies.</li>
<li>Wait until pods and services are ready to be used.</li>
<li>Make created services, replication controllers and kubernetes client available inside your test case (via @ArquillianResource).</li>
</ul>
<p><a href="https://github.com/fabric8io/fabric8/tree/master/components/fabric8-arquillian" _target="blank">fabric8-arquillian</a> uses:</p>
<ul>
<li>Kubnernetes to provision and orchestrate the containers inside a new unique namespace; so that each test case is isolated from other environments and test cases</li>
<li><a href="http://arquillian.org/" _target="blank">Arquillian</a> to run the JUnit tests and perform the necessary dependency injection</li>
<li><a href="https://github.com/fabric8io/fabric8/tree/master/components/kubernetes-assertions" _target="blank">kubernetes-assertions</a> and <a href="https://github.com/fabric8io/fabric8/tree/master/components/jolokia-assertions" _target="blank">jolokia-assertions</a> to provide assertions within the JUnit test case.</li>
</ul>
<h3 id="session-lifecycle--labels"><a name="undefined" class="plugin-anchor" href="#undefined"><span class="fa fa-link"></span></a>Session, Lifecycle &amp; Labels</h3>
<p>The kubernetes configuration is applied once per test suite. This means that the environment is getting created once per test suite and then multiple test cases are run against that environment.
To encapsulate everything that has been applied to kubernetes as part of the current test suite, the notion of &quot;session&quot; is used.</p>
<p>In order to distinguish which pods, services and replication controllers have been created as part of the testing session, anything that is created using the arquillian extension, will be created inside a unique namespace per session.
This namespace is also going to be used to cleanup everything after the end of the suite or upon termination of the process.</p>
<p>The Session is also made available to the test cases as an arquillian resource <em>(see below)</em>.</p>
<h3 id="keeping-the-namespace-around"><a name="undefined" class="plugin-anchor" href="#undefined"><span class="fa fa-link"></span></a>Keeping the namespace around</h3>
<p>If a test fails you may want to look inside the Kubernetes namespace took at the failed pods. By default the namespace gets garbage collected immediately.</p>
<p>To delay this you can use these environment variables</p>
<ul>
<li>FABRIC8_NAMESPACE_CONFIRM_DESTROY set this to &apos;true&apos; to force the user to type &apos;Q&apos; in the command line terminal to terminate the namespace</li>
<li>FABRIC8_NAMESPACE_DESTROY_TIMEOUT set this to the number of seconds to keep the namespace around for before destroying it</li>
</ul>
<h3 id="arquillian-resources-available-to-test-cases"><a name="undefined" class="plugin-anchor" href="#undefined"><span class="fa fa-link"></span></a>Arquillian Resources available to test cases</h3>
<p>A typical integration test, would need to apply the kubernetes configuration, wait for everything to start up and then assert that that expected pods and services are available and of course test the actual services.</p>
<p>To do that, the test needs to have access to information like:</p>
<ul>
<li>Pods</li>
<li>Services</li>
<li>Replication Controllers</li>
<li>Session Namespace</li>
</ul>
<p>Each of the items above is made available to the test as an arquillian resource. </p>
<p>To obtain a reference to the KubernetesClient:</p>
<pre><code> @ArquillianResource
 io.fabric8.kubernetes.api.KubernetesClient client;
</code></pre><h4 id="services"><a name="undefined" class="plugin-anchor" href="#undefined"><span class="fa fa-link"></span></a>Services</h4>
<p>To obtain the list of all services created in the current session:</p>
<pre><code>@ArquillianResource
io.fabric8.kubernetes.api.model.ServiceList sessionServices;
</code></pre><p>To obtain a reference to a particular service created in the current session:</p>
<pre><code>@Id(&quot;my-service-id&quot;)
@ArquillianResource
io.fabric8.kubernetes.api.model.Service myService;
</code></pre><h4 id="replication-controllers"><a name="undefined" class="plugin-anchor" href="#undefined"><span class="fa fa-link"></span></a>Replication Controllers</h4>
<p>To obtain the list of all replication controllers created in the current session:</p>
<pre><code>@ArquillianResource
io.fabric8.kubernetes.api.model.ReplicationControllerList sessionControllers;
</code></pre><p>To obtain a refernce to a particular replication controller created in the current session:</p>
<pre><code>@Id(&quot;my-controller-id&quot;)
@ArquillianResource
io.fabric8.kubernetes.api.model.ReplicationController myController;
</code></pre><p>To obtain the list of all pods created in the current session:</p>
<pre><code>@ArquillianResource
io.fabric8.kubernetes.api.model.PodList sessionPods;
</code></pre><p>To obtain the Session:</p>
<pre><code> @ArquillianResource
 io.fabric8.arquillian.kubernetes.Session mySession;
</code></pre><h3 id="configuration-options"><a name="undefined" class="plugin-anchor" href="#undefined"><span class="fa fa-link"></span></a>Configuration Options</h3>
<p>Any configuration option can be provided as an environment variable, system property or arquillian property. 
For example:</p>
<pre><code>    &lt;arquillian xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
                xmlns=&quot;http://jboss.org/schema/arquillian&quot;
                xsi:schemaLocation=&quot;http://jboss.org/schema/arquillian
                http://jboss.org/schema/arquillian/arquillian_1_0.xsd&quot;&gt;

        &lt;extension qualifier=&quot;kubernetes&quot;&gt;
            &lt;property name=&quot;masterUrl&quot;&gt;true&lt;/property&gt;
        &lt;/extension&gt;
    &lt;/arquillian&gt;
</code></pre><p>The only required configuration option is url to the kubernetes master. Since in most cases this will be specified as KUBERNETES_MASTER env variable, there is no need
to specify it again. 
This means that the arquillian.xml configuration file is completely optional.</p>
<p>Supported options:</p>
<ul>
<li>masterUrl: The url to the kubernetes master.</li>
<li>configFileName: If a url hasn&apos;t been explicitly specified, the configFileName can be used for discovery of the configuration in the classpath.</li>
<li>configUrl: The url to the kubernetes configuration to be tested.</li>
<li>connectToServices: Whether or not an attempt is made to connect to a service port; failing the test if it can&apos;t be connected. This is disabled by default since its likely a service PortalIP / port cannot be opened by the JUnit test case (and may require authentication)</li>
<li>dependencies: A space separated list of directories, files or urls to kubernetes configurations that are required to be applied before the current one.</li>
<li>waitForServiceConnection: Wait until a network connection to all applied services is possible.</li>
<li>serviceConnectionTimeout: The connection timeout for each attempt to &quot;connect to the service&quot;.</li>
<li>waitForServices: Explicitly specify which services to wait. If this option is ommitted or empty all services will be waited.</li>
<li>timeout: The total amount of time for to wait for pods and service to be ready.</li>
<li>pollInterval: The interval between polling the status of pods and services.</li>
</ul>
<h3 id="maven-integration"><a name="undefined" class="plugin-anchor" href="#undefined"><span class="fa fa-link"></span></a>Maven Integration</h3>
<p>If dependencies have not been explicitly specified, the extension will find all test scoped dependencies and search inside those artifacts for kubernetes.json resources.
Then it will treat those as dependencies and apply them along with the configuration.</p>
<p>One thing to be careful of is that adding test dependencies on kubernetes.json will add transitive dependencies to your test project; so you may want to add exclusions as <a href="https://github.com/fabric8io/fabric8/blob/master/itests/pom.xml#L57" _target="blank">this example shows</a>.</p>
<h3 id="example"><a name="undefined" class="plugin-anchor" href="#undefined"><span class="fa fa-link"></span></a>Example</h3>
<p>There are lots of examples in the <a href="quickstarts/">quickstarts</a>.</p>
<p>Here is an <a href="https://github.com/fabric8io/fabric8/blob/master/itests/src/test/java/io/fabric8/itests/BrokerProducerConsumerIT.java#L57" _target="blank">example Arquillian Fabric8 integration test</a> that tests that an AMQ broker, producer and consumer startup and properly produce and consume messages correctly.</p>
<p>In particular <a href="https://github.com/fabric8io/fabric8/blob/master/itests/src/test/java/io/fabric8/itests/BrokerProducerConsumerIT.java#L74" _target="blank">here is the code that does JMX assertions via jolokia on the containers</a> that are created by the integration test.</p>
<h3 id="requirements"><a name="undefined" class="plugin-anchor" href="#undefined"><span class="fa fa-link"></span></a>Requirements</h3>
<p>When running an <strong>fabric8-arquillian</strong> integration test then the environment variable <strong>KUBERNETES_MASTER</strong> needs to be specified to point to the kubernetes environment in which to create the containers and services.</p>
<p>Also you may want to set the <strong>KUBERNETES_TRUST_CERTIFICATES</strong> variable to allow connection to kubernetes without a client certificatE:</p>
<pre><code>export KUBERNETES_TRUST_CERTIFICATES=true
export KUBERNETES_MASTER=http://localhost:8443
</code></pre><p>Note that this can be any kubernetes environment (a kubernetes installation, OpenShift, RHEL Atomic or GKE). Also note that different integration tests can be running at the same time on the same kubernetes environment.</p>
<p>If you find that you are getting exceptions and output of the form:</p>
<pre><code>Waiting for: SomeException....
Waiting for: SomeException....
</code></pre><p>and if the exception isn&apos;t clear from the message, you could define this environment variable to get an additional full stack trace (which is very noisy but can be handy):</p>
<pre><code>export FABRIC8_VERBOSE_ASSERT=true
</code></pre><h3 id="assertion-libraries"><a name="undefined" class="plugin-anchor" href="#undefined"><span class="fa fa-link"></span></a>Assertion libraries</h3>
<p>The following libraries are provided to help you create concise assertions using <a href="http://joel-costigliola.github.io/assertj/" _target="blank">assertj</a> based DSL:</p>
<ul>
<li><a href="https://github.com/fabric8io/fabric8/tree/master/components/kubernetes-assertions" _target="blank">kubernetes-assertions</a> provides a set of <a href="http://joel-costigliola.github.io/assertj/" _target="blank">assertj</a> assertions of the form <strong>assertThat(kubernetesResource)</strong> for working with the <a href="https://github.com/fabric8io/fabric8/tree/master/components/kubernetes-api" _target="blank">kubernetes-api</a></li>
<li><a href="https://github.com/fabric8io/fabric8/tree/master/components/jolokia-assertions" _target="blank">jolokia-assertions</a> makes it easy to perform assertions on remote JVMs via JMX using  <a href="http://jolokia.org/" _target="blank">Jolokia</a> over HTTP/JSON</li>
<li><a href="https://github.com/fabric8io/fabric8/tree/master/components/kubernetes-jolokia" _target="blank">kubernetes-jolokia</a> makes it easy to work with the <a href="http://jolokia.org/reference/html/clients.html#client-java" _target="blank">Jolokia Client API</a> and Java containers running in <a href="http://fabric8.io/guide/pods.html" _target="blank">Pods</a> inside Kubernetes which expose the Jolokia port</li>
</ul>
<h3 id="add-it-to-your-maven-pomxml"><a name="undefined" class="plugin-anchor" href="#undefined"><span class="fa fa-link"></span></a>Add it to your Maven pom.xml</h3>
<p>To be able to use this library add this to your <a href="http://maven.apache.org/" _target="blank">Apache Maven</a> based project add this into your pom.xml</p>
<pre><code>        &lt;dependency&gt;
            &lt;groupId&gt;io.fabric8&lt;/groupId&gt;
            &lt;artifactId&gt;fabric8-arquillian&lt;/artifactId&gt;
            &lt;version&gt;2.2.101&lt;/version&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
</code></pre>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="tools.html" class="navigation navigation-prev " aria-label="Previous page: Tools">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="forge.html" class="navigation navigation-next " aria-label="Next page: Forge">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Testing","level":"1.8.1","depth":2,"next":{"title":"Forge","level":"1.8.2","depth":2,"path":"forge.md","ref":"forge.md","articles":[{"title":"Camel Maven Plugin","level":"1.8.2.1","depth":3,"path":"camelMavenPlugin.md","ref":"camelMavenPlugin.md","articles":[]}]},"previous":{"title":"Tools","level":"1.8","depth":1,"path":"tools.md","ref":"tools.md","articles":[{"title":"Testing","level":"1.8.1","depth":2,"path":"testing.md","ref":"testing.md","articles":[]},{"title":"Forge","level":"1.8.2","depth":2,"path":"forge.md","ref":"forge.md","articles":[{"title":"Camel Maven Plugin","level":"1.8.2.1","depth":3,"path":"camelMavenPlugin.md","ref":"camelMavenPlugin.md","articles":[]}]},{"title":"Maven Plugin","level":"1.8.3","depth":2,"path":"mavenPlugin.md","ref":"mavenPlugin.md","articles":[{"title":"docker:build","level":"1.8.3.1","depth":3,"path":"mavenDockerBuild.md","ref":"mavenDockerBuild.md","articles":[]},{"title":"docker:push","level":"1.8.3.2","depth":3,"path":"mavenDockerPush.md","ref":"mavenDockerPush.md","articles":[]},{"title":"fabric8:apply","level":"1.8.3.3","depth":3,"path":"mavenFabric8Apply.md","ref":"mavenFabric8Apply.md","articles":[]},{"title":"fabric8:create-env","level":"1.8.3.4","depth":3,"path":"mavenFabric8CreateEnv.md","ref":"mavenFabric8CreateEnv.md","articles":[]},{"title":"fabric8:create-routes","level":"1.8.3.5","depth":3,"path":"mavenFabric8CreateRoutes.md","ref":"mavenFabric8CreateRoutes.md","articles":[]},{"title":"fabric8:delete-pods","level":"1.8.3.6","depth":3,"path":"mavenFabric8DeletePods.md","ref":"mavenFabric8DeletePods.md","articles":[]},{"title":"fabric8:devops","level":"1.8.3.7","depth":3,"path":"mavenFabric8DevOps.md","ref":"mavenFabric8DevOps.md","articles":[]},{"title":"fabric8:helm","level":"1.8.3.8","depth":3,"path":"mavenFabric8Helm.md","ref":"mavenFabric8Helm.md","articles":[]},{"title":"fabric8:helm-push","level":"1.8.3.9","depth":3,"path":"mavenFabric8HelmPush.md","ref":"mavenFabric8HelmPush.md","articles":[]},{"title":"fabric8:json","level":"1.8.3.10","depth":3,"path":"mavenFabric8Json.md","ref":"mavenFabric8Json.md","articles":[{"title":"annotation processors","level":"1.8.3.10.1","depth":4,"path":"annotationProcessors.md","ref":"annotationProcessors.md","articles":[]}]},{"title":"fabric8:recreate","level":"1.8.3.11","depth":3,"path":"mavenFabric8Recreate.md","ref":"mavenFabric8Recreate.md","articles":[]},{"title":"fabric8:rolling","level":"1.8.3.12","depth":3,"path":"mavenFabric8Rolling.md","ref":"mavenFabric8Rolling.md","articles":[]}]},{"title":"Helm","level":"1.8.4","depth":2,"path":"helm.md","ref":"helm.md","articles":[]},{"title":"Java Libraries","level":"1.8.5","depth":2,"path":"javaLibraries.md","ref":"javaLibraries.md","articles":[]},{"title":"CDI","level":"1.8.6","depth":2,"path":"cdi.md","ref":"cdi.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["anchors"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"anchors":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"github":"fabric8io/fabric8","theme":"default","githubHost":"https://github.com/","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":36,"bottom":36},"toc":true},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Fabric8 Documentation","links":{"home":"http://fabric8.io/","about":"http://fabric8.io/docs/index.html","issues":"https://github.com/fabric8io/fabric8/issues?milestone=none&state=closed","contribute":"http://fabric8.io/contributing/index.html","sharing":{"google":null,"facebook":null,"twitter":"https://twitter.com/fabric8io"}},"gitbook":">=2.0.0","description":"Fabric8 User Guide and Reference Documentation","extension":"pdf"},"file":{"path":"testing.md","mtime":"2016-05-31T16:42:57.000Z","type":"markdown"},"gitbook":{"version":"3.0.3","time":"2016-05-31T16:46:06.540Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/buttons.js"></script>
        
    

    </body>
</html>

